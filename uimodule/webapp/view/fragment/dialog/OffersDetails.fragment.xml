<core:FragmentDefinition
	xmlns="sap.m"
  xmlns:core="sap.ui.core"
  xmlns:ui="sap.ui.table"
  xmlns:l="sap.ui.layout"
	xmlns:gnt2="sap.gantt.simple"
  xmlns:axistime="sap.gantt.axistime"
	xmlns:config="sap.gantt.config"
>
  <l:FixFlex minFlexSize="500">
    <l:fixContent>
      <ObjectHeader
          visible="{= ${detailsDialog>/offers/panel/selectedOffer} ? true : false }"
          icon="sap-icon://customer-financial-fact-sheet"
          title="{detailsDialog>/offers/panel/selectedOffer/name}"
          number="{detailsDialog>/offers/panel/selectedOffer/amount}"
          numberUnit="Eur"
        >
          <attributes>
            <ObjectAttribute text="Customer Name: {detailsDialog>/offers/panel/selectedOffer/customer_name}" />
            <ObjectAttribute text="Commercial: {detailsDialog>/offers/panel/selectedOffer/commercial}" />
            <ObjectAttribute text="Pays: {detailsDialog>/offers/panel/selectedOffer/pays}" />
          </attributes>
          <statuses>
            <ObjectStatus
              visible="{= ${detailsDialog>/offers/panel/selectedOffer} ? true : false }"
              text="Expired"
              state="Error" 
            />
          </statuses>
        </ObjectHeader>     
    </l:fixContent>
    <l:flexContent>
      <gnt2:GanttChartContainer 
        width="100%"
        height="100%"
        enableTimeScrollSync="true"
      >
        <gnt2:toolbar>
          <gnt2:ContainerToolbar 
            design="Auto" 
            showSettingButton="false"
            showBirdEyeButton="false" 
            showDisplayTypeButton="false"
            showLegendButton="false" 
            showSearchButton="false"
          />
        </gnt2:toolbar>

        <gnt2:GanttChartWithTable 
          width="100%"
          height="100%"
          ghostAlignment="Start" 
          adhocLineLayer="Bottom"
          shapeSelectionMode = "Single"
          selectionPanelSize="50%"
          enableChartOverflowToolbar="true"
          shapeSelectionSettings="{color:'red', strokeDasharray:'1,0'}"
          shapePress=".onGanttChartShapePress"
        >
          <gnt2:table>
            <ui:TreeTable
              selectionMode="None"
              visibleRowCountMode="Auto"
              rows="{
                path: 'detailsDialog>/offers/treeTable/rows',
                parameters: {
                  arrayNames: ['rows']
                }
              }"
            >
              <ui:columns>
                <ui:Column sortProperty="RequirementID" filterProperty="RequirementID">
                  <Text text="Customer Name" wrapping="false"/>
                  <ui:template>
                    <HBox>
                      <items>
                        <Label text="{detailsDialog>name}"/>
                      </items>
                    </HBox>
                  </ui:template>
                </ui:Column>
                <ui:Column sortProperty="RequirementID" filterProperty="RequirementID">
                  <Text text="Start Date" wrapping="false"/>
                  <ui:template>
                    <HBox>
                      <items>
                        <Label text="{
                          path: 'detailsDialog>startDate',
                          formatter: '.formatter.formatStandardDate'
                        }"/>
                      </items>
                    </HBox>
                  </ui:template>
                </ui:Column>
                <ui:Column sortProperty="RequirementID" filterProperty="RequirementID">
                  <Text text="End Date" wrapping="false"/>
                  <ui:template>
                    <HBox>
                      <items>
                        <Label text="{
                          path: 'detailsDialog>endDate',
                          formatter: '.formatter.formatStandardDate'
                        }"/>
                      </items>
                    </HBox>
                  </ui:template>
                </ui:Column>
              </ui:columns>
              <ui:rowSettingsTemplate>
                <gnt2:GanttRowSettings 
                  rowId="{detailsDialog>offer_number}"
                >
                  <gnt2:shapes1>
                    <gnt2:BaseRectangle
                      shapeId="{detailsDialog>offer_number}" 
                      countInBirdEye="true"
                      time="{detailsDialog>startDate}" 
                      endTime="{detailsDialog>endDate}"
                      resizable="false" 
                      selectable="true" 
                      draggable= "true"
                      title="{detailsDialog>name}" 
                      showTitle="true"
                      tooltip="{detailsDialog>name}"
                      fill="green"
                    />
                  </gnt2:shapes1>
                </gnt2:GanttRowSettings>
              </ui:rowSettingsTemplate>
            </ui:TreeTable>
          </gnt2:table>

          <gnt2:axisTimeStrategy>
            <axistime:ProportionZoomStrategy>
              <axistime:totalHorizon>
                <config:TimeHorizon startTime="20220101000000" endTime="20221201000000"/>
              </axistime:totalHorizon>
              <axistime:visibleHorizon>
                <config:TimeHorizon startTime="20220701000000" endTime="20220801000000"/>
              </axistime:visibleHorizon>
            </axistime:ProportionZoomStrategy>
          </gnt2:axisTimeStrategy>
        </gnt2:GanttChartWithTable>
      </gnt2:GanttChartContainer>
    </l:flexContent>
  </l:FixFlex>
</core:FragmentDefinition>