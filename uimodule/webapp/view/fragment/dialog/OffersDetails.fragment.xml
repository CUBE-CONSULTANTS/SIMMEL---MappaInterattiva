<core:FragmentDefinition
	xmlns:core="sap.ui.core"
	xmlns:unified="sap.ui.unified"
	xmlns:m="sap.m"
  xmlns="sap.ui.table"
>
    <m:VBox>
      <m:items>
        <m:HBox class="sapUiTinyMargin">
          <m:SegmentedButton 
            width="auto" 
            items="{detail>/detailsDialog/offers/segmentedButton/items}"
            selectedKey="{detail>/detailsDialog/offers/segmentedButton/selectedKey}"
          >
            <m:items>
              <m:SegmentedButtonItem width="100%" text="{detail>text}" key="{detail>key}" />
            </m:items>
          </m:SegmentedButton>
        </m:HBox>
        <Table
          visible="{= ${detail>/detailsDialog/offers/segmentedButton/selectedKey} === 'table'}"
          visibleRowCount="20"
          selectionMode="None"
          rows="{detailsDialog>/offers/table/items}"
        >
          <columns>
            <Column sortProperty="offer_number" filterProperty="offer_number">
              <m:Label text="Offer Number" />
              <template>
                <m:Text text="{detailsDialog>offer_number}" />
              </template>
            </Column>
            <Column sortProperty="pays" filterProperty="pays">
              <m:Label text="Pays" />
              <template>
                <m:Text text="{detailsDialog>pays}" />
              </template>
            </Column>
            <Column sortProperty="customer_name" filterProperty="customer_name">
              <m:Label text="Customer Name" />
              <template>
                <m:Text text="{detailsDialog>customer_name}" />
              </template>
            </Column>
            <Column sortProperty="offer_title" filterProperty="offer_title">
              <m:Label text="Offer Title" />
              <template>
                <m:Text text="{detailsDialog>offer_title}" />
              </template>
            </Column>
            <Column sortProperty="signature_date" filterProperty="signature_date">
              <m:Label text="Signature Date" />
              <template>
                <m:Text text="{detailsDialog>signature_date}" />
              </template>
            </Column>
            <Column sortProperty="amount" filterProperty="amount">
              <m:Label text="Amount" />
              <template>
                <m:Text text="{detailsDialog>amount}" />
              </template>
            </Column>
            <Column sortProperty="date" filterProperty="date">
              <m:Label text="Date" />
              <template>
                <m:Text text="{
                  path: 'detailsDialog>date',
                  formatter: '.formatter.formatStandardDate'
                }" />
              </template>
            </Column>
            <Column sortProperty="commercial" filterProperty="commercial">
              <m:Label text="Commercial" />
              <template>
                <m:Text text="{detailsDialog>commercial}" />
              </template>
            </Column>
          </columns>
        </Table>
        <m:PlanningCalendar
          visible="{= ${detail>/detailsDialog/offers/segmentedButton/selectedKey} === 'calendar'}"
          viewKey="Week"
          builtInViews="Week,OneMonth"
          stickyHeader="true"
          rows="{detailsDialog>/offers/calendar/items}"
          showIntervalHeaders="false"
          showEmptyIntervalHeaders="false"
          appointmentsVisualization="Filled"
          appointmentHeight="Regular"
          showDayNamesLine="true"
          appointmentSelect=".onAppointmentPress"
          startDateChange=".onStartDateChange"
        >
          <m:rows>
            <m:PlanningCalendarRow
              title="{detailsDialog>customer_name}"
              enableAppointmentsDragAndDrop="false"
              enableAppointmentsResize="false"
              enableAppointmentsCreate="false"
              appointments="{
                path: 'detailsDialog>offers',
                templateShareable: false
              }"
            >
              <m:appointments>
                <unified:CalendarAppointment
                  startDate="{
                    path: 'detailsDialog>date',
                    formatter: '.formatter.formatStartDate'
                  }"
                  endDate="{
                    path: 'detailsDialog>date',
                    formatter: '.formatter.formatEndDate'
                  }"
                  title="{detailsDialog>offer_title}"
                  text="{detailsDialog>pays}"
                />
              </m:appointments>
            </m:PlanningCalendarRow>
          </m:rows>
        </m:PlanningCalendar>
      </m:items>
    </m:VBox>
</core:FragmentDefinition>